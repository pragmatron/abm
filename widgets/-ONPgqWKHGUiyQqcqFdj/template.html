<div class="row">
  <div class="col-lg-12 col-sm-12 column">

    <!-- Slim CARD CONTAINER -->
    <div class="d-flex flex-column p-2 bg-white">

      <!-- Card Title -->
      <h6 class="font-weight-bold mb-2">Sales Orders Overview</h6>

      <!-- METRICS ROW -->
      <div class="d-flex justify-content-start align-items-center w-100 flex-wrap gap-2">

        <!-- NEW -->
        <div class="d-flex flex-column align-items-start justify-content-center flex-grow-1 mx-1 p-2 rounded"
          style="background-color: #bdd5ea; color: #000; min-width: 120px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-file-alt mr-2"></i>
            <small>New</small>
          </div>
          <div style="font-size: 1rem; font-weight: bold;">
            {{
              $getGrid('opportunities')
                ? $getGrid('opportunities').filter(q => q.$status$display === 'New').length
                : 'Loading...'
            }}
          </div>
        </div>

        <!-- PLANNED -->
        <div class="d-flex flex-column align-items-start justify-content-center flex-grow-1 mx-1 p-2 rounded"
          style="background-color: #fff4b8; color: #000; min-width: 120px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-tasks mr-2"></i>
            <small>Planned</small>
          </div>
          <div style="font-size: 1rem; font-weight: bold;">
            {{
              $getGrid('opportunities')
                ? $getGrid('opportunities').filter(q => q.$status$display === 'Planned').length
                : 'Loading...'
            }}
          </div>
        </div>

        <!-- IN PROGRESS COUNT -->
        <div class="d-flex flex-column align-items-start justify-content-center flex-grow-1 mx-1 p-2 rounded"
          style="background-color: #b2dbbf; color: #000; min-width: 120px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-spinner mr-2"></i>
            <small>In Progress</small>
          </div>
          <div style="font-size: 1rem; font-weight: bold;">
            {{
              $getGrid('opportunities')
                ? $getGrid('opportunities').filter(q => q.$status$display === 'In Progress').length
                : 'Loading...'
            }}
          </div>
        </div>

        <!-- IN PROGRESS TOTAL -->
        <div class="d-flex flex-column align-items-start justify-content-center flex-grow-1 mx-1 p-2 rounded"
          style="background-color: #b2dbbf; color: #000; min-width: 150px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-dollar-sign mr-2"></i>
            <small>In Progress ($)</small>
          </div>
          <div style="font-size: 1rem; font-weight: bold;">
            {{
              $getGrid('opportunities')
                ? $getGrid('opportunities')
                    .filter(q => q.$status$display === 'In Progress')
                    .reduce((acc, q) => acc + parseFloat(q.totalQuoteLinePrice || 0), 0)
                    .toLocaleString('en-US', { style: 'currency', currency: 'USD' })
                : 'Loading...'
            }}
          </div>
        </div>

        <!-- COMPLAINTS -->
        <div class="d-flex flex-column align-items-start justify-content-center flex-grow-1 mx-1 p-2 rounded"
          style="background-color: #f8d7da; color: #000; min-width: 120px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-info-circle mr-2"></i>
            <small>Open Complaints</small>
          </div>
          <div style="font-size: 1rem; font-weight: bold;">
            {{
              $getGrid('complaintTracker')
                ? $getGrid('complaintTracker').filter(c => c.$stage$display !== 'Resolved').length
                : 'Loading...'
            }}
          </div>
        </div>

        <!-- HEALTH STATUS -->
        <div class="d-flex flex-column align-items-start justify-content-start mx-1 p-2 rounded"
          style="background-color: #e0e0e0; color: #000; min-width: 120px;">
          <div class="d-flex align-items-center mb-1" style="font-size: 0.85rem;">
            <i class="fas fa-heartbeat mr-2"></i>
            <small>Health</small>
          </div>
          <div class="d-flex justify-content-between align-items-center w-100">
            <div class="d-flex align-items-center justify-content-center px-2 py-1 rounded mx-1"
              style="background-color: rgba(13, 129, 49, 0.4); font-size: 0.75rem;">
              <i class="fas fa-check-circle mr-1"></i>
              <small>On Time (0)</small>
            </div>
            <div class="d-flex align-items-center justify-content-center px-2 py-1 rounded mx-1"
              style="background-color: rgba(255, 179, 0, 0.484); font-size: 0.75rem;">
              <i class="fas fa-exclamation-triangle mr-1"></i>
              <small>At Risk (0)</small>
            </div>
            <div class="d-flex align-items-center justify-content-center px-2 py-1 rounded mx-1"
              style="background-color: rgba(255, 0, 0, 0.415); font-size: 0.75rem;">
              <i class="fas fa-times-circle mr-1"></i>
              <small>Past Due (0)</small>
            </div>
          </div>
        </div>

      </div> <!-- End METRICS ROW -->

    </div> <!-- End CARD CONTAINER -->

  </div>
</div>
